!function(){"use strict";var e=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}updateUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}getInitialData(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a37d83b2-08ce-4c01-92cc-3eaed253626a","Content-Type":"application/json"}});class t{constructor(e,t,s,r){this._name=e.name,this._link=e.link,this._id=e._id,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=r,this._isRemoved=!1}_setEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeIcon())),this._trashButton.addEventListener("click",(()=>{this._isRemoved||this._handleDeleteClick(this._id)})),this._cardImage.addEventListener("click",(()=>this._handleImageClick(this._name,this._link)))}removeCard(){this._cardElement&&!this._isRemoved?(console.log(`Removing card with ID: ${this._id}`),this._cardElement.remove(),this._cardElement=null,this._isRemoved=!0,console.log(`Card with ID ${this._id} successfully removed.`)):console.warn(`Card element with ID ${this._id} is already removed or null.`)}_handleLikeIcon(){this._likeButton.classList.toggle("card__like-button_active")}getView(){const e=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);return this._cardElement=e,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._trashButton=this._cardElement.querySelector(".card__trash-button"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardElement.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._cardElement}}class s{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e,t){const s=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_toggleButtonState(){const e=this._inputEls.some((e=>!e.validity.valid));this.disableSubmitButton(e)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._toggleButtonState()}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this.disableSubmitButton(!0)}disableSubmitButton(e){e?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}}class r{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&this.close()}))}}class n extends r{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popupElement.querySelector(".popup__form"),this._inputList=this._form.querySelectorAll(".popup__input"),this._submitButton=this._form.querySelector(".popup__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{e[t.name]&&(t.value=e[t.name])}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitButton.textContent="Saving...",this._handleFormSubmit(this._getInputValues()).then((()=>this.close())).catch((e=>console.error(e))).finally((()=>{this._submitButton.textContent=this._submitButtonText}))}))}close(){super.close(),this._form.reset()}}function i(e,t){u.open({name:e,link:t})}function o(s){const r=new t(s,"#card-template",i,(t=>{console.log(`Opening confirmation popup for card ID: ${t}`),p.setSubmitAction((()=>(console.log(`Submitting delete request for card ID: ${t}`),e.deleteCard(t).then((()=>{console.log(`API delete successful for card ID: ${t}`),r.removeCard(),p.close()})).catch((e=>console.error("Error deleting card:",e)))))),p.open()}));return r.getView()}const a=document.querySelector("#profile-edit-button"),l=document.querySelector("#add-card-button"),c=document.querySelector(".profile__avatar-edit-button"),h=new class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(e){Array.isArray(e)?e.forEach((e=>{this._renderer(e)})):console.error("Items passed to renderItems are not an array:",e)}addItem(e){this._container.prepend(e)}}({items:[],renderer:e=>{const t=o(e);h.addItem(t)}},".cards__list"),u=new class extends r{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".popup__preview-image"),this._popupCaption=this._popupElement.querySelector(".popup__preview-caption")}open(e){let{name:t,link:s}=e;this._popupImage.src=s,this._popupImage.alt=t,this._popupCaption.textContent=t,super.open()}}("#preview-image-popup"),d=new n("#profile-edit-popup",(t=>e.updateUserInfo({name:t.title,about:t.description}).then((e=>{E.setUserInfo({name:e.name,job:e.about}),d.close()})).catch((e=>console.error("Error updating profile:",e))))),_=new n("#add-card-popup",(t=>e.addCard({name:t.title,link:t.url}).then((e=>{const t=o(e);h.addItem(t),_.close()})).catch((e=>console.error("Error adding card:",e))))),p=new class extends r{constructor(e){super(e),this._submitButton=this._popupElement.querySelector(".popup__button_confirm")}setSubmitAction(e){this._handleSubmit=e}setEventListeners(){super.setEventListeners(),this._submitButton.addEventListener("click",(()=>{this._handleSubmit&&!this._submitInProgress&&(this._submitInProgress=!0,this._handleSubmit().finally((()=>{this._submitInProgress=!1})))}))}}("#delete-card-popup");p.setEventListeners();const m=new n("#avatar-edit-popup",(t=>e.updateAvatar(t.avatar).then((e=>{E.setUserInfo({name:e.name,job:e.about,avatar:e.avatar}),m.close()})).catch((e=>console.error("Error updating avatar:",e)))));m.setEventListeners();const E=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(r),this._userId=null,this._nameElement&&this._jobElement&&this._avatarElement||console.error("One or more user info elements could not be found.")}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){let{name:t,job:s,avatar:r,id:n}=e;t&&(this._nameElement.textContent=t),s&&(this._jobElement.textContent=s),r&&(this._avatarElement.src=r),n&&(this._userId=n)}getUserId(){return this._userId}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"});u.setEventListeners(),d.setEventListeners(),_.setEventListeners(),p.setEventListeners(),e.getInitialData().then((e=>{let[t,s]=e;E.setUserInfo({name:t.name,job:t.about,avatar:t.avatar,id:t._id}),h.renderItems(s)})).catch((e=>{console.error("Error fetching data:",e)})),a.addEventListener("click",(()=>{const e=E.getUserInfo();d.open(),d.setInputValues({title:e.name,description:e.job})})),c.addEventListener("click",(()=>{m.open()})),l.addEventListener("click",(()=>{_.open()}));const b={};(e=>{const t=Array.from(document.querySelectorAll(e.formSelector));console.log("Forms found by formSelector:",t),t.forEach((t=>{const r=new s(e,t),n=t.getAttribute("name");console.log("Initializing validator for form:",n),b[n]=r,r.enableValidation()}))})({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SSxtQ0FBb0M2SSxHQUNoREwsRUFBZUssR0FBWUQsRUFDM0JBLEVBQVU3RixrQkFBa0IsR0FDNUIsRUFHSkEsQ0NqS2tDLENBQ2hDNEYsYUFBYyxlQUNkekgsY0FBZSxnQkFDZkUscUJBQXNCLGlCQUN0QkUsb0JBQXFCLHlCQUNyQkUsZ0JBQWlCLDBCQUNqQkUsV0FBWSx3QiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICB9XG5cbiAgLy8gSGVscGVyIG1ldGhvZCB0byBjaGVjayB0aGUgcmVzcG9uc2VcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIC8vIE1ldGhvZCB0byBnZXQgdXNlciBpbmZvcm1hdGlvblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBNZXRob2QgdG8gZ2V0IGluaXRpYWwgY2FyZHNcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIC8vIE1ldGhvZCB0byB1cGRhdGUgdXNlciBwcm9maWxlXG4gIHVwZGF0ZVVzZXJJbmZvKGRhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgLy8gTWV0aG9kIHRvIGFkZCBhIG5ldyBjYXJkXG4gIGFkZENhcmQoZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGxpbms6IGRhdGEubGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBDb21iaW5lZCBtZXRob2QgdG8gZmV0Y2ggdXNlciBpbmZvIGFuZCBjYXJkc1xuICBnZXRJbml0aWFsRGF0YSgpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xuICB9XG5cbiAgLy9tZXRob2QgdG8gZGVsZXRlXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gQWRkIGEgbGlrZSB0byBhIGNhcmRcbiAgYWRkTGlrZShjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBSZW1vdmUgYSBsaWtlIGZyb20gYSBjYXJkXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlQXZhdGFyKGF2YXRhclVybCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogYXZhdGFyVXJsIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxufVxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhMzdkODNiMi0wOGNlLTRjMDEtOTJjYy0zZWFlZDI1MzYyNmFcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBhcGk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVEZWxldGVDbGljaykge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICAgIHRoaXMuX2lzUmVtb3ZlZCA9IGZhbHNlO1xuICB9XG5cbiAgLy8gU2V0IHVwIGV2ZW50IGxpc3RlbmVyc1xuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUljb24oKSk7XG4gICAgdGhpcy5fdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGlmICghdGhpcy5faXNSZW1vdmVkKSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuX2lkKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXG4gICAgKTtcbiAgfVxuXG4gIC8vIFJlbW92ZSB0aGUgY2FyZCBlbGVtZW50XG4gIHJlbW92ZUNhcmQoKSB7XG4gICAgaWYgKCF0aGlzLl9jYXJkRWxlbWVudCB8fCB0aGlzLl9pc1JlbW92ZWQpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgYENhcmQgZWxlbWVudCB3aXRoIElEICR7dGhpcy5faWR9IGlzIGFscmVhZHkgcmVtb3ZlZCBvciBudWxsLmBcbiAgICAgICk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYFJlbW92aW5nIGNhcmQgd2l0aCBJRDogJHt0aGlzLl9pZH1gKTtcblxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgICB0aGlzLl9pc1JlbW92ZWQgPSB0cnVlO1xuXG4gICAgY29uc29sZS5sb2coYENhcmQgd2l0aCBJRCAke3RoaXMuX2lkfSBzdWNjZXNzZnVsbHkgcmVtb3ZlZC5gKTtcbiAgfVxuXG4gIC8vIFRvZ2dsZSBsaWtlIGJ1dHRvblxuICBfaGFuZGxlTGlrZUljb24oKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgLy8gQ3JlYXRlIGFuZCByZXR1cm4gdGhlIGNhcmQgZWxlbWVudFxuICBnZXRWaWV3KCkge1xuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX3RyYXNoQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaC1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsLCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH1cbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBjb25zdCBoYXNJbnZhbGlkSW5wdXQgPSB0aGlzLl9pbnB1dEVscy5zb21lKFxuICAgICAgKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkXG4gICAgKTtcbiAgICB0aGlzLmRpc2FibGVTdWJtaXRCdXR0b24oaGFzSW52YWxpZElucHV0KTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfSk7XG4gICAgdGhpcy5kaXNhYmxlU3VibWl0QnV0dG9uKHRydWUpO1xuICB9XG5cbiAgZGlzYWJsZVN1Ym1pdEJ1dHRvbihpc0Rpc2FibGVkKSB7XG4gICAgaWYgKGlzRGlzYWJsZWQpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7IC8vIFNlbGVjdCB0aGUgcG9wdXAgZWxlbWVudFxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTsgLy8gRW5zdXJlIGNvcnJlY3QgJ3RoaXMnIGNvbnRleHRcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikgfHxcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZVwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlmIChkYXRhW2lucHV0Lm5hbWVdKSB7XG4gICAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSlcbiAgICAgICAgLnRoZW4oKCkgPT4gdGhpcy5jbG9zZSgpKVxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKVxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgfVxufVxuIiwiLy9pbXBvcnQgYWxsIGNsYXNzZXNcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbmltcG9ydCB7IHNlbGVjdG9ycywgdmFsaWRhdGlvblNldHRpbmdzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IGFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuXG4vLyBGdW5jdGlvbiB0byBoYW5kbGUgaW1hZ2UgY2xpY2tzXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcbiAgaW1hZ2VQb3B1cC5vcGVuKHsgbmFtZSwgbGluayB9KTtcbn1cblxuLy8gQ3JlYXRlIGNhcmQgZnVuY3Rpb25cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGNhcmREYXRhLFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIChjYXJkSWQpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBPcGVuaW5nIGNvbmZpcm1hdGlvbiBwb3B1cCBmb3IgY2FyZCBJRDogJHtjYXJkSWR9YCk7XG5cbiAgICAgIGRlbGV0ZUNvbmZpcm1hdGlvblBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBTdWJtaXR0aW5nIGRlbGV0ZSByZXF1ZXN0IGZvciBjYXJkIElEOiAke2NhcmRJZH1gKTtcbiAgICAgICAgcmV0dXJuIGFwaVxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmRJZClcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQVBJIGRlbGV0ZSBzdWNjZXNzZnVsIGZvciBjYXJkIElEOiAke2NhcmRJZH1gKTtcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgICAgICAgZGVsZXRlQ29uZmlybWF0aW9uUG9wdXAuY2xvc2UoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgY2FyZDpcIiwgZXJyKSk7XG4gICAgICB9KTtcblxuICAgICAgZGVsZXRlQ29uZmlybWF0aW9uUG9wdXAub3BlbigpO1xuICAgIH1cbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufVxuXG4vLyBET00gZWxlbWVudHNcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMucHJvZmlsZUVkaXRCdXR0b24pO1xuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLmFkZENhcmRCdXR0b24pO1xuY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWVkaXQtYnV0dG9uXCIpO1xuXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IFtdLFxuICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoaXRlbSk7XG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xuICAgIH0sXG4gIH0sXG4gIHNlbGVjdG9ycy5jYXJkU2VjdGlvblxuKTtcblxuLy8gUG9wdXAgaW5zdGFuY2VzXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHNlbGVjdG9ycy5wcmV2aWV3SW1hZ2VQb3B1cCk7XG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHNlbGVjdG9ycy5wcm9maWxlRWRpdFBvcHVwLFxuICAoZm9ybURhdGEpID0+IHtcbiAgICByZXR1cm4gYXBpXG4gICAgICAudXBkYXRlVXNlckluZm8oe1xuICAgICAgICBuYW1lOiBmb3JtRGF0YS50aXRsZSxcbiAgICAgICAgYWJvdXQ6IGZvcm1EYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgfSlcbiAgICAgIC50aGVuKCh1cGRhdGVkRGF0YSkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgICAgbmFtZTogdXBkYXRlZERhdGEubmFtZSxcbiAgICAgICAgICBqb2I6IHVwZGF0ZWREYXRhLmFib3V0LFxuICAgICAgICB9KTtcbiAgICAgICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgcHJvZmlsZTpcIiwgZXJyKSk7XG4gIH1cbik7XG5cbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHNlbGVjdG9ycy5hZGRDYXJkUG9wdXAsIChmb3JtRGF0YSkgPT4ge1xuICByZXR1cm4gYXBpXG4gICAgLmFkZENhcmQoe1xuICAgICAgbmFtZTogZm9ybURhdGEudGl0bGUsXG4gICAgICBsaW5rOiBmb3JtRGF0YS51cmwsXG4gICAgfSlcbiAgICAudGhlbigobmV3Q2FyZCkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQobmV3Q2FyZCk7XG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBjYXJkOlwiLCBlcnIpKTtcbn0pO1xuXG5jb25zdCBkZWxldGVDb25maXJtYXRpb25Qb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXG4gIHNlbGVjdG9ycy5kZWxldGVDYXJkUG9wdXBcbik7XG5kZWxldGVDb25maXJtYXRpb25Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhdmF0YXJFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhdmF0YXItZWRpdC1wb3B1cFwiLCAoZm9ybURhdGEpID0+IHtcbiAgcmV0dXJuIGFwaVxuICAgIC51cGRhdGVBdmF0YXIoZm9ybURhdGEuYXZhdGFyKVxuICAgIC50aGVuKCh1cGRhdGVkVXNlckluZm8pID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgbmFtZTogdXBkYXRlZFVzZXJJbmZvLm5hbWUsXG4gICAgICAgIGpvYjogdXBkYXRlZFVzZXJJbmZvLmFib3V0LFxuICAgICAgICBhdmF0YXI6IHVwZGF0ZWRVc2VySW5mby5hdmF0YXIsXG4gICAgICB9KTtcbiAgICAgIGF2YXRhckVkaXRQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyBhdmF0YXI6XCIsIGVycikpO1xufSk7XG5hdmF0YXJFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gVXNlciBJbmZvIGluc3RhbmNlXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3Rvcjogc2VsZWN0b3JzLnByb2ZpbGVUaXRsZSxcbiAgam9iU2VsZWN0b3I6IHNlbGVjdG9ycy5wcm9maWxlRGVzY3JpcHRpb24sXG4gIGF2YXRhclNlbGVjdG9yOiBzZWxlY3RvcnMucHJvZmlsZUF2YXRhcixcbn0pO1xuXG4vLyBJbml0aWFsaXplIHBvcHVwc1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xucHJvZmlsZUVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5kZWxldGVDb25maXJtYXRpb25Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBGZXRjaCBpbml0aWFsIGRhdGEgKHVzZXIgaW5mbyBhbmQgY2FyZHMpXG5hcGlcbiAgLmdldEluaXRpYWxEYXRhKClcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcbiAgICAgIGpvYjogdXNlckRhdGEuYWJvdXQsXG4gICAgICBhdmF0YXI6IHVzZXJEYXRhLmF2YXRhcixcbiAgICAgIGlkOiB1c2VyRGF0YS5faWQsXG4gICAgfSk7XG5cbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcyk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGRhdGE6XCIsIGVycik7XG4gIH0pO1xuXG4vLyBFdmVudCBsaXN0ZW5lcnNcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZUVkaXRQb3B1cC5vcGVuKCk7XG4gIHByb2ZpbGVFZGl0UG9wdXAuc2V0SW5wdXRWYWx1ZXMoe1xuICAgIHRpdGxlOiB1c2VyRGF0YS5uYW1lLFxuICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5qb2IsXG4gIH0pO1xufSk7XG5cbmF2YXRhckVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYXZhdGFyRWRpdFBvcHVwLm9wZW4oKTtcbn0pO1xuXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gRm9ybSB2YWxpZGF0aW9uXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHNldHRpbmdzKSA9PiB7XG4gIGNvbnN0IGZvcm1zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3RvcikpO1xuICBjb25zb2xlLmxvZyhcIkZvcm1zIGZvdW5kIGJ5IGZvcm1TZWxlY3RvcjpcIiwgZm9ybXMpO1xuICBmb3Jtcy5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCk7XG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xuICAgIGNvbnNvbGUubG9nKFwiSW5pdGlhbGl6aW5nIHZhbGlkYXRvciBmb3IgZm9ybTpcIiwgZm9ybU5hbWUpO1xuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5cbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvblNldHRpbmdzKTtcbiIsImV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XG4gIHByb2ZpbGVFZGl0UG9wdXA6IFwiI3Byb2ZpbGUtZWRpdC1wb3B1cFwiLFxuICBhZGRDYXJkUG9wdXA6IFwiI2FkZC1jYXJkLXBvcHVwXCIsXG4gIHByZXZpZXdJbWFnZVBvcHVwOiBcIiNwcmV2aWV3LWltYWdlLXBvcHVwXCIsXG4gIHByb2ZpbGVUaXRsZTogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgcHJvZmlsZURlc2NyaXB0aW9uOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICBwcm9maWxlQXZhdGFyOiBcIi5wcm9maWxlX19pbWFnZVwiLFxuICBwcm9maWxlRWRpdEJ1dHRvbjogXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiLFxuICBhZGRDYXJkQnV0dG9uOiBcIiNhZGQtY2FyZC1idXR0b25cIixcbiAgY2FyZFNlY3Rpb246IFwiLmNhcmRzX19saXN0XCIsXG4gIHByb2ZpbGVUaXRsZUlucHV0OiBcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0OiBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCIsXG4gIGFkZENhcmRUaXRsZUlucHV0OiBcIiNhZGQtY2FyZC10aXRsZS1pbnB1dFwiLFxuICBhZGRDYXJkVXJsSW5wdXQ6IFwiI2FkZC1jYXJkLXVybC1pbnB1dFwiLFxuICBkZWxldGVDYXJkUG9wdXA6IFwiI2RlbGV0ZS1jYXJkLXBvcHVwXCIsXG4gIGRlbGV0ZUNvbmZpcm1hdGlvblBvcHVwOiBcIi5wb3B1cF90eXBlX2RlbGV0ZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXG59O1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoaXRlbXMpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiSXRlbXMgcGFzc2VkIHRvIHJlbmRlckl0ZW1zIGFyZSBub3QgYW4gYXJyYXk6XCIsIGl0ZW1zKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucG9wdXBfX3ByZXZpZXctaW1hZ2VcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5wb3B1cF9fcHJldmlldy1jYXB0aW9uXCJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xyXG5cclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucG9wdXBfX2J1dHRvbl9jb25maXJtXCJcbiAgICApO1xuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGFjdGlvbjtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5faGFuZGxlU3VibWl0ICYmICF0aGlzLl9zdWJtaXRJblByb2dyZXNzKSB7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEluUHJvZ3Jlc3MgPSB0cnVlO1xuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKS5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICB0aGlzLl9zdWJtaXRJblByb2dyZXNzID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG5cbiAgICB0aGlzLl91c2VySWQgPSBudWxsO1xuXG4gICAgLy8gTG9nIGFuIGVycm9yIGlmIGFueSBvZiB0aGUgZWxlbWVudHMgYXJlIG5vdCBmb3VuZFxuICAgIGlmICghdGhpcy5fbmFtZUVsZW1lbnQgfHwgIXRoaXMuX2pvYkVsZW1lbnQgfHwgIXRoaXMuX2F2YXRhckVsZW1lbnQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJPbmUgb3IgbW9yZSB1c2VyIGluZm8gZWxlbWVudHMgY291bGQgbm90IGJlIGZvdW5kLlwiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHVzZXIgaW5mb3JtYXRpb24gZnJvbSB0aGUgcGFnZS5cbiAgICogQHJldHVybnMge09iamVjdH0gVXNlciBkYXRhIHdpdGggYG5hbWVgIGFuZCBgam9iYC5cbiAgICovXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB1c2VyIGluZm9ybWF0aW9uIG9uIHRoZSBwYWdlIGFuZCBzdG9yZSB1c2VyIElELlxuICAgKiBAcGFyYW0ge09iamVjdH0gdXNlckluZm8gLSBDb250YWlucyBgbmFtZWAsIGBqb2JgLCBgYXZhdGFyYCwgYW5kIGBpZGAuXG4gICAqL1xuICBzZXRVc2VySW5mbyh7IG5hbWUsIGpvYiwgYXZhdGFyLCBpZCB9KSB7XG4gICAgaWYgKG5hbWUpIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICBpZiAoam9iKSB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xuICAgIGlmIChhdmF0YXIpIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICAgIGlmIChpZCkgdGhpcy5fdXNlcklkID0gaWQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBzdG9yZWQgdXNlciBJRC5cbiAgICogQHJldHVybnMge3N0cmluZ3xudWxsfSBVc2VyIElEIG9yIG51bGwgaWYgbm90IHNldC5cbiAgICovXG4gIGdldFVzZXJJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fdXNlcklkO1xuICB9XG59XG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJvcHRpb25zIiwidGhpcyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0SW5pdGlhbENhcmRzIiwidXBkYXRlVXNlckluZm8iLCJkYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJuYW1lIiwiYWJvdXQiLCJhZGRDYXJkIiwibGluayIsImdldEluaXRpYWxEYXRhIiwiYWxsIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwidXBkYXRlQXZhdGFyIiwiYXZhdGFyVXJsIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsIkNhcmQiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJfbmFtZSIsIl9saW5rIiwiX2lkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2lzUmVtb3ZlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlSWNvbiIsIl90cmFzaEJ1dHRvbiIsIl9jYXJkSW1hZ2UiLCJyZW1vdmVDYXJkIiwiX2NhcmRFbGVtZW50IiwiY29uc29sZSIsImxvZyIsInJlbW92ZSIsIndhcm4iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJnZXRWaWV3IiwiY2FyZFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2UiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwiYWRkIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImhhc0ludmFsaWRJbnB1dCIsIl9pbnB1dEVscyIsInNvbWUiLCJkaXNhYmxlU3VibWl0QnV0dG9uIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJpc0Rpc2FibGVkIiwiZGlzYWJsZWQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0TGlzdCIsIl9zdWJtaXRCdXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJldnQiLCJjYXRjaCIsImVyciIsImVycm9yIiwiZmluYWxseSIsInJlc2V0IiwiaW1hZ2VQb3B1cCIsImNyZWF0ZUNhcmQiLCJjYXJkRGF0YSIsImNhcmQiLCJkZWxldGVDb25maXJtYXRpb25Qb3B1cCIsInNldFN1Ym1pdEFjdGlvbiIsImFwaSIsInByb2ZpbGVFZGl0QnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsImF2YXRhckVkaXRCdXR0b24iLCJjYXJkU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJBcnJheSIsImlzQXJyYXkiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBDYXB0aW9uIiwicHJvZmlsZUVkaXRQb3B1cCIsImZvcm1EYXRhIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInVwZGF0ZWREYXRhIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImpvYiIsImFkZENhcmRQb3B1cCIsInVybCIsIm5ld0NhcmQiLCJhY3Rpb24iLCJfaGFuZGxlU3VibWl0IiwiX3N1Ym1pdEluUHJvZ3Jlc3MiLCJhdmF0YXJFZGl0UG9wdXAiLCJ1cGRhdGVkVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsIl91c2VySWQiLCJfcmVmMiIsImdldFVzZXJJZCIsInVzZXJEYXRhIiwiY2FyZHMiLCJmb3JtVmFsaWRhdG9ycyIsImZvcm1zIiwiZnJvbSIsImZvcm1TZWxlY3RvciIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIl0sInNvdXJjZVJvb3QiOiIifQ==